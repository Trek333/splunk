<!-- File: readme.html
  Copyright (c) 2014-2019 Splunk Inc.

  SPLUNK CONFIDENTIAL - Use or disclosure of this material in whole or in part
  without a valid written license from Splunk Inc. is PROHIBITED.
-->

<h2> Asset Configuration Parameters </h2>
<ul>
  <li>
    on_poll_display:
    <ul>
      <li>Fields to save with On Poll.</li>
      <li>User can select the fields from the events which the user wants to ingest in the artifact.</li>
      <li>If the on_poll_display parameter is not provided then, all the fields that are extracted from the events will be ingested in the respective artifacts.</li>
    </ul>
  </li>
  <li>
    If the on_poll_query( Query to use with On Poll ) parameter is not provided then, an error message will be returned.<br>
  </li>
  <li>
    If the on_poll_command( Command for query to use with On Poll ) parameter is not provided and if the on_poll_query does not starts with "|" or "search" then, "search" keyword is added in the beginning of the on_poll_query.<br>
    Example:
      <ul>
        <li>
          on_poll_command : None<br>
          on_poll_query : index = "main"<br>
          Final query generated internally : search index = "main"
        </li>
      </ul>
  </li>
  <li>
    If the on_poll_command parameter is not provided and if the on_poll_query starts with "|" or "search" then, the final query would be the same as the query provided in the on_poll_query parameter.<br>
    Example:
      <ul>
        <li>
          on_poll_command : None<br>
          on_poll_query : search index = "main"<br>
          Final query generated internally : search index = "main"
        </li>
      </ul>
  </li>
  <li>
    If on_poll_command parameter is provided then, query is formed as : {on_poll_command} {on_poll_query}.<br>
    Example:
      <ul>
        <li>
          on_poll_command : search<br>
          on_poll_query : index = "main"<br>
          Final query generated internally : search index = "main"
        </li>
      </ul>
  </li>
</ul>


<h2> On Poll </h2>
<ul>
  <li>Note</li>
  <ul>
    <li>
      In case "on poll" returns any 4XX except 403, validate your search Query on Splunk.
    </li>
    <li>
      Sample "Query" to use with On Poll: index="_internal" | stats count by host, source, sourcetype | head 5 | rename host as h0st |  rename source as devicehostname.
    </li>
    <li>
      Sample "Fields to save with On Poll" (if none given, "on poll" shall store all the fields): source,sourcetype,hostname.
    </li>
    <li>
      The <b>on_poll_parse_only</b> parameter, if <b>True</b>, it disables the expansion of search due to evaluation of sub-searches, time term expansion, lookups, tags, eventtypes, and sourcetype alias. This parameter is used for the validation of the Splunk query before fetching the results.
    </li>
  </ul>
  <br>
  <li>Helpful examples to run on poll</li>
  <ol>
    <li>
      on_poll_command : "search"<br>
      on_poll_query : index = "main" | head 10<br>
      Final query generated internally : search index = "main" | head 10<br>
      The query will fetch top 10 events from the result of index = "main" search.
    </li>
    <li>
      on_poll_command : "savedsearch"<br>
      on_poll_query: "Dashboard Views - Action History"<br>
      Final query generated internally : savedsearch "Dashboard Views - Action History"<br>
      The query will execute the query saved in the savedsearch named "Dashboard Views - Action History".
    </li>
    <li>
      on_poll_command : "tstats"<br>
      on_poll_query : "count from datamodel=Authentication"<br>
      Final query generated internally : "tstats count from datamodel=Authentication"<br>
      The query will perform statistics for datamodel and will give total count of events fetched for datamodel = authentication.
    </li>
    <li>
      on_poll_command : None<br>
      on_poll_query : index = "_internal" | table a<br>
      Final query generated internally : search index = "_internal" | table a<br>
      The query will  display field "a" in table format for the results fetched from 'search index = "_internal"' search.
    </li>
    <li>
      on_poll_command : None<br>
      on_poll_query: index=* sourcetype="modular_alerts:notable" app="phantom" user="admin"<br>
      Final query generated internally : search index=* sourcetype="modular_alerts:notable" app="phantom" user="admin"<br>
      This query will fetch all the events with sourcetype = "modular_alerts:notable", app="phantom", and user="admin".
    </li>
    <li>
      on_poll_command : None<br>
      on_poll_query: index="main" | stats count<br>
      Final query generated internally : search index="main" | stats count<br>
      This query will get the count of the events that are indexed in index named "main".
    </li>
    <li>
      on_poll_command : None<br>
      on_poll_query: index="main" | eval a = "abc"<br>
      Final query generated internally : search index="main" | eval a = "abc"<br>
      This query will add a field with name = "a" and value = "abc" in all the events that are indexed in index named "main".
    </li>
    <li>
      on_poll_command : None<br>
      on_poll_query: index="main" | fields sourcetype<br>
      Final query generated internally : search index="main" | fields sourcetype<br>
      This query will fetch only the sourcetype of all the events that are indexed in index named "main".
    </li>
    <li>
      on_poll_command : None<br>
      on_poll_query: index="_internal" tag=error<br>
      Final query generated internally : search index="_internal" tag="error"<br>
      This query will fetch all the events having tag = error and index = main.
    </li>
    <li>
      on_poll_command : None<br>
      on_poll_query : |inputlookup ppf_action_history_searches<br>
      Final query generated internally : |inputlookup ppf_action_history_searches<br>
      This query will show the data of "ppf_action_history_searches" lookup.
    </li>
  </ol>
</ul>
<h2>Naming Ingested Containers</h2>
<p>
By default, the "source" field is used to name the ingested containers.
To customize the container names, use the two settings in the asset configuration.
For example, if a hostname is expected in the container name, the "Name to give containers created via ingestion" parameter
can be set to "Notable Splunk Event" and "Values to append to container name" parameter can be set to "host".
This will set the container name to "Notable Splunk Event, host=my.sample.host".
The appended values can be a comma-separated list.
</p>
